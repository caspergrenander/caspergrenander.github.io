<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AutoPublisher ‚Äì Upload Interface</title>
<style>
body {
  margin: 0;
  padding: 0;
  background: #1A2838;
  color: #F5E5C8;
  font-family: "Segoe UI", Roboto, Arial, sans-serif;
  line-height: 1.7;
}

header {
  padding: 60px 20px 40px;
  text-align: center;
  background: #0D0F15;
  border-bottom: 1px solid #2A4A4A;
}

header a {
  color: inherit;
  text-decoration: none;
  display: inline-block;
  text-align: center;
}

header img {
  width: 180px;
  border-radius: 6px;
  margin-bottom: 20px;
  box-shadow: 0 0 15px rgba(0,0,0,0.5);
}

h1 {
  color: #FFFFFF;
  margin-bottom: 10px;
  font-weight: 600;
  font-size: 22px;
}

h2 {
  color: #FFFFFF;
  font-weight: 600;
  margin-top: 30px;
  border-bottom: 1px solid #2A4A4A;
  padding-bottom: 10px;
}

h3 {
  color: #FFFFFF;
  font-weight: 600;
  margin-top: 25px;
  margin-bottom: 15px;
  font-size: 18px;
}

p {
  max-width: 800px;
  margin: 15px auto;
  padding: 0 20px;
  color: #F5E5C8;
}

a {
  color: #D88B5C;
  text-decoration: none;
  transition: color 0.2s;
}
a:hover {
  color: #E8B65C;
  text-decoration: underline;
}

.container {
  max-width: 900px;
  margin: auto;
  background: #0D0F15;
  padding: 40px 30px;
  border-radius: 6px;
  margin-top: 40px;
  margin-bottom: 40px;
  border: 1px solid #2A4A4A;
}

footer {
  margin-top: 60px;
  padding: 40px 20px;
  text-align: center;
  font-size: 0.9rem;
  color: #2A4A4A;
  border-top: 1px solid #2A4A4A;
  background: #0D0F15;
}

.subtitle {
  color: #2A4A4A;
  font-size: 14px;
  margin-top: 5px;
  letter-spacing: 1px;
}

.footer-content {
  max-width: 800px;
  margin: 0 auto;
}

.footer-links {
  margin: 20px 0;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 15px;
}

.footer-links a {
  color: #2A4A4A;
  font-size: 0.85rem;
}

.footer-links a:hover {
  color: #D88B5C;
}

/* UI Components */
.ui-box {
  background-color: rgba(42, 74, 74, 0.1);
  padding: 30px;
  border-radius: 8px;
  margin: 30px 0;
  border: 1px solid #2A4A4A;
}

.button {
  background-color: #E8B65C;
  color: #1A2838;
  border: none;
  padding: 14px 28px;
  border-radius: 6px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  display: inline-block;
  margin: 10px 5px;
  min-width: 220px;
}

.button:hover {
  background-color: #F5C97C;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(232, 182, 92, 0.3);
}

.button:active {
  transform: translateY(0);
}

.button:disabled {
  background-color: #2A4A4A;
  color: #7A8C9C;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.button.secondary {
  background-color: transparent;
  color: #D88B5C;
  border: 2px solid #D88B5C;
}

.button.secondary:hover {
  background-color: rgba(216, 139, 92, 0.1);
  color: #E8B65C;
}

.button.tertiary {
  background-color: rgba(42, 74, 74, 0.3);
  color: #F5E5C8;
  border: 2px solid #2A4A4A;
}

.button.tertiary:hover {
  background-color: rgba(42, 74, 74, 0.5);
  border-color: #E8B65C;
  color: #E8B65C;
}

.textarea {
  width: 100%;
  max-width: 100%;
  min-height: 100px;
  padding: 15px;
  margin: 15px 0;
  background-color: rgba(42, 74, 74, 0.2);
  border: 1px solid #2A4A4A;
  border-radius: 6px;
  color: #F5E5C8;
  font-family: inherit;
  font-size: 15px;
  box-sizing: border-box;
}

.textarea:focus {
  outline: none;
  border-color: #E8B65C;
  box-shadow: 0 0 0 2px rgba(232, 182, 92, 0.2);
}

.textarea::placeholder {
  color: #7A8C9C;
}

.upload-area {
  border: 2px dashed #2A4A4A;
  border-radius: 8px;
  padding: 40px;
  text-align: center;
  margin: 20px 0;
  cursor: pointer;
  transition: all 0.3s ease;
}

.upload-area:hover {
  border-color: #E8B65C;
  background-color: rgba(232, 182, 92, 0.05);
}

.upload-area.active {
  border-color: #E8B65C;
  background-color: rgba(232, 182, 92, 0.1);
}

.upload-icon {
  font-size: 48px;
  color: #2A4A4A;
  margin-bottom: 15px;
}

.upload-area:hover .upload-icon {
  color: #E8B65C;
}

.file-info {
  background-color: rgba(42, 74, 74, 0.2);
  padding: 15px;
  border-radius: 6px;
  margin: 15px 0;
  border-left: 4px solid #E8B65C;
}

/* Status Message */
.status-message {
  margin: 25px 0;
  padding: 20px;
  border-radius: 8px;
  font-weight: 500;
  text-align: center;
  opacity: 0;
  transform: translateY(10px);
  transition: all 0.5s ease;
  min-height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
}

.status-message.show {
  opacity: 1;
  transform: translateY(0);
}

.status-ready {
  background-color: rgba(232, 182, 92, 0.15);
  border: 2px solid #E8B65C;
  color: #E8B65C;
}

.status-queued {
  background-color: rgba(42, 74, 74, 0.4);
  border: 2px solid #2A4A4A;
  color: #F5E5C8;
}

.status-processing {
  background-color: rgba(42, 74, 74, 0.3);
  border: 2px solid #2A4A4A;
  color: #F5E5C8;
}

.status-success {
  background-color: rgba(42, 74, 74, 0.4);
  border: 2px solid #2A4A4A;
  color: #F5E5C8;
}

.status-error {
  background-color: rgba(216, 139, 92, 0.15);
  border: 2px solid #D88B5C;
  color: #D88B5C;
}

.status-subtext {
  font-size: 14px;
  color: #2A4A4A;
  margin-top: 8px;
  font-weight: normal;
}

/* Controls Row */
.controls-row {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  margin: 25px 0;
  justify-content: center;
}

.note-box {
  background-color: rgba(42, 74, 74, 0.15);
  padding: 20px;
  border-radius: 6px;
  margin: 25px 0;
  border-left: 4px solid #2A4A4A;
  font-size: 14px;
}

.note-box p:last-child {
  margin-bottom: 0;
}

.input-row {
  display: flex;
  gap: 20px;
  margin: 20px 0;
}

.input-group {
  flex: 1;
}

.input-group label {
  display: block;
  margin-bottom: 8px;
  color: #FFFFFF;
  font-weight: 500;
}

.back-link {
  display: inline-block;
  margin-top: 20px;
  color: #D88B5C;
  font-size: 0.9em;
}

.back-link:hover {
  color: #E8B65C;
}

.workflow-info {
  background-color: rgba(232, 182, 92, 0.1);
  border: 1px solid #E8B65C;
  border-radius: 6px;
  padding: 15px;
  margin: 20px 0;
  font-size: 14px;
}

.workflow-info h3 {
  color: #E8B65C;
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 16px;
}

.user-action-note {
  background-color: rgba(216, 139, 92, 0.1);
  border: 1px solid #D88B5C;
  border-radius: 6px;
  padding: 15px;
  margin: 20px 0;
  font-size: 14px;
}

.user-action-note h3 {
  color: #D88B5C;
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 16px;
}

/* UPPDATERAD: Demo Note styling */
.demo-note {
  background-color: rgba(42, 74, 74, 0.2);
  border: 1px dashed #2A4A4A;
  border-radius: 6px;
  padding: 12px 15px;
  margin: 10px 0;
  font-size: 13px;
  color: #2A4A4A;
  text-align: center;
}

.demo-mode-indicator {
  text-align: center;
  margin: 15px 0;
  font-size: 13px;
  color: #2A4A4A;
  font-style: italic;
}

.api-requirement-note {
  background-color: rgba(216, 139, 92, 0.15);
  border: 1px solid #D88B5C;
  border-radius: 6px;
  padding: 15px;
  margin: 15px 0;
  font-size: 13px;
}

.api-requirement-note h4 {
  color: #D88B5C;
  margin-top: 0;
  margin-bottom: 8px;
  font-size: 14px;
}

.button-label-small {
  font-size: 12px;
  color: #2A4A4A;
  margin-top: 5px;
  text-align: center;
  font-style: italic;
}

.disabled-feature {
  opacity: 0.5;
  cursor: not-allowed !important;
}

.disabled-feature:hover {
  transform: none !important;
  box-shadow: none !important;
}

.scheduling-note {
  background-color: rgba(42, 74, 74, 0.25);
  border: 1px solid #2A4A4A;
  border-radius: 6px;
  padding: 20px;
  margin: 20px 0;
  text-align: center;
  font-size: 14px;
}

.scheduling-note p {
  margin: 0;
  color: #7A8C9C;
}

.scheduling-note strong {
  color: #F5E5C8;
}

/* NYA STYLES F√ñR TIKTOK AUDIT */
.creator-info-box {
  background-color: rgba(232, 182, 92, 0.15);
  border: 2px solid #E8B65C;
  border-radius: 8px;
  padding: 20px;
  margin: 20px 0;
  text-align: center;
}

.creator-info-box h3 {
  color: #E8B65C;
  margin-top: 0;
  margin-bottom: 10px;
}

.creator-username {
  font-size: 24px;
  font-weight: 700;
  color: #FFFFFF;
  margin: 10px 0;
}

.privacy-section {
  margin: 25px 0;
}

.privacy-section label {
  display: block;
  margin-bottom: 10px;
  color: #FFFFFF;
  font-weight: 500;
}

.privacy-dropdown {
  width: 100%;
  padding: 12px;
  background-color: rgba(42, 74, 74, 0.2);
  border: 1px solid #2A4A4A;
  border-radius: 6px;
  color: #F5E5C8;
  font-size: 15px;
  cursor: pointer;
}

.privacy-dropdown:focus {
  outline: none;
  border-color: #E8B65C;
}

.privacy-dropdown option {
  background-color: #0D0F15;
  color: #F5E5C8;
}

.interaction-controls {
  background-color: rgba(42, 74, 74, 0.1);
  border-radius: 8px;
  padding: 20px;
  margin: 20px 0;
  border: 1px solid #2A4A4A;
}

.interaction-controls h3 {
  margin-top: 0;
}

.control-checkbox {
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 12px 0;
}

.control-checkbox input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.control-checkbox label {
  color: #F5E5C8;
  cursor: pointer;
  user-select: none;
}

.commercial-section {
  background-color: rgba(216, 139, 92, 0.15);
  border: 1px solid #D88B5C;
  border-radius: 8px;
  padding: 20px;
  margin: 20px 0;
}

.commercial-toggle {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 15px;
}

.commercial-toggle input[type="checkbox"] {
  width: 20px;
  height: 20px;
  cursor: pointer;
}

.commercial-toggle label {
  color: #D88B5C;
  font-weight: 600;
  cursor: pointer;
  font-size: 16px;
}

.commercial-options {
  margin-top: 15px;
  padding-left: 30px;
  display: none;
}

.commercial-options.show {
  display: block;
}

.commercial-option {
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 10px 0;
}

.commercial-option input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.commercial-option label {
  color: #F5E5C8;
  cursor: pointer;
}

.consent-section {
  background-color: rgba(42, 74, 74, 0.2);
  border: 1px solid #2A4A4A;
  border-radius: 8px;
  padding: 20px;
  margin: 20px 0;
}

.consent-checkbox {
  display: flex;
  align-items: flex-start;
  gap: 10px;
}

.consent-checkbox input[type="checkbox"] {
  width: 20px;
  height: 20px;
  margin-top: 3px;
  cursor: pointer;
}

.consent-checkbox label {
  color: #F5E5C8;
  cursor: pointer;
  line-height: 1.5;
}

.video-preview-container {
  margin: 20px 0;
  display: none;
}

.video-preview-container.show {
  display: block;
}

.video-preview {
  width: 100%;
  max-width: 400px;
  border-radius: 8px;
  border: 2px solid #2A4A4A;
  margin: 0 auto;
  display: block;
}

.validation-error {
  color: #ff6b6b;
  font-size: 14px;
  margin-top: 5px;
  display: none;
}

.validation-error.show {
  display: block;
}

.form-group {
  margin-bottom: 20px;
}
</style>
</head>

<body>

<header>
  <a href="https://caspergrenander.github.io/historienbakomusiken/projekt-info/">
    <img src="/historienbakomusiken/historienbakomusiken/assets/logo.png" alt="Historien Bakom Musiken Logo">
    <h1>AutoPublisher</h1>
  </a>
  <p class="subtitle">User-Initiated Upload & Publishing Interface</p>
</header>

<div class="container">
  <p>
    Users manually upload and publish videos to <strong>their own TikTok account</strong>.
    No actions are automated.
  </p>

  <div class="user-action-note">
    <h3>‚ö†Ô∏è Important: User-Initiated Actions Only</h3>
    <p>Every action on this page requires explicit user interaction. The system does not perform any automated actions without user clicks and confirmations.</p>
  </div>

  <!-- 1Ô∏è‚É£ CREATOR INFO (OBLIGATORISKT) -->
  <div class="creator-info-box">
    <h3>Posting as</h3>
    <div class="creator-username" id="creatorUsername">@demo_user_123</div>
    <p style="color: #2A4A4A; font-size: 14px; margin: 5px 0 0 0;">Content will be published to this TikTok account</p>
  </div>

  <div class="workflow-info">
    <h3>üìã Current Workflow Status</h3>
    <p><strong>Direct Post API:</strong> Awaiting approval from TikTok</p>
    <p><strong>Current Method:</strong> Videos are queued for manual review and API approval</p>
  </div>

  <div class="ui-box">
    <h2>Upload Video</h2>

    <!-- Upload Area -->
    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">üìÅ</div>
      <p>Click to select video file or drag and drop here</p>
      <p style="color: #2A4A4A; font-size: 14px; margin-top: 10px;">Accepted: MP4, MOV, AVI (max 100MB)</p>
    </div>

    <input type="file" id="videoFile" accept="video/*" style="display:none">

    <!-- 6Ô∏è‚É£ VIDEO PREVIEW -->
    <div class="video-preview-container" id="videoPreviewContainer">
      <h3>Video Preview</h3>
      <video id="videoPreview" class="video-preview" controls>
        Your browser does not support the video tag.
      </video>
    </div>

    <div id="fileInfo" class="file-info" style="display:none;">
      <p style="margin: 0; font-weight: 500;">Selected file: <span id="fileName"></span></p>
      <p style="margin: 5px 0 0 0; font-size: 14px; color: #2A4A4A;">Size: <span id="fileSize"></span></p>
    </div>

    <!-- Caption & Hashtags -->
    <div class="input-row">
      <div class="input-group">
        <label for="caption">Video Caption</label>
        <textarea id="caption" class="textarea" placeholder="Write an engaging caption for your video..."></textarea>
      </div>

      <div class="input-group">
        <label for="hashtags">Hashtags</label>
        <textarea id="hashtags" class="textarea" placeholder="#music #history #creativity #behindthescenes"></textarea>
      </div>
    </div>

    <!-- 2Ô∏è‚É£ PRIVACY STATUS DROPDOWN -->
    <div class="privacy-section">
      <label for="privacy">Privacy Status *</label>
      <select id="privacy" class="privacy-dropdown">
        <option value="">Select privacy...</option>
        <option value="PUBLIC">Public</option>
        <option value="FRIENDS">Friends</option>
        <option value="PRIVATE">Only me</option>
      </select>
      <div class="validation-error" id="privacyError">Please select a privacy option</div>
    </div>

    <!-- 3Ô∏è‚É£ INTERACTION CONTROLS -->
    <div class="interaction-controls">
      <h3>Interaction Controls</h3>
      <div class="control-checkbox">
        <input type="checkbox" id="allowComment">
        <label for="allowComment">Allow comments</label>
      </div>
      <div class="control-checkbox">
        <input type="checkbox" id="allowDuet">
        <label for="allowDuet">Allow duet</label>
      </div>
      <div class="control-checkbox">
        <input type="checkbox" id="allowStitch">
        <label for="allowStitch">Allow stitch</label>
      </div>
      <p style="color: #2A4A4A; font-size: 13px; margin-top: 10px;">All options are disabled by default. Enable as desired.</p>
    </div>

    <!-- 4Ô∏è‚É£ COMMERCIAL CONTENT DISCLOSURE -->
    <div class="commercial-section">
      <div class="commercial-toggle">
        <input type="checkbox" id="commercialToggle">
        <label for="commercialToggle">This post contains commercial content *</label>
      </div>
      <div class="validation-error" id="commercialError">Please select at least one commercial content type</div>
      
      <div class="commercial-options" id="commercialOptions">
        <div class="commercial-option">
          <input type="checkbox" id="commercialYourBrand">
          <label for="commercialYourBrand">Your Brand</label>
        </div>
        <div class="commercial-option">
          <input type="checkbox" id="commercialBrandedContent">
          <label for="commercialBrandedContent">Branded Content</label>
        </div>
      </div>
      <p style="color: #2A4A4A; font-size: 13px; margin-top: 10px;">* Required if commercial content is selected</p>
    </div>

    <!-- 5Ô∏è‚É£ CONSENT DECLARATION -->
    <div class="consent-section">
      <div class="consent-checkbox">
        <input type="checkbox" id="consentCheckbox">
        <label for="consentCheckbox">
          By posting, you agree to TikTok's Terms of Service, Community Guidelines, 
          and Music Usage Confirmation. You confirm that you have the rights to 
          publish this content and that it complies with all applicable policies.
        </label>
      </div>
      <div class="validation-error" id="consentError">You must agree to the terms before publishing</div>
    </div>

    <div class="controls-row">
      <button class="button secondary" id="generateBtn">
        Generate Suggestions
      </button>
    </div>

    <!-- UPPDATERAD: √Ñndrat fr√•n "future functionality" -->
    <div class="demo-note">
      <strong>Note:</strong> This interface demonstrates the user flow for Direct Post API functionality.
    </div>

    <div class="status-message" id="statusMessage"></div>

    <!-- PUBLISH BUTTONS -->
    <div class="controls-row">
      <button class="button" id="publishBtn" disabled>Publish (API approval required)</button>
      <button class="button tertiary" id="queueBtn" disabled>Queue for API approval</button>
    </div>

    <div class="demo-mode-indicator">
      Demo mode ‚Äì Live publishing requires TikTok Direct Post API approval
    </div>

    <div class="api-requirement-note">
      <h4>API Requirements Status</h4>
      <p><strong>Current Status:</strong> Awaiting TikTok Direct Post API approval for live publishing functionality.</p>
      <p><strong>"Queue for API approval":</strong> Demonstrates the workflow for manual review while API access is pending.</p>
      <p><strong>"Publish":</strong> Will be enabled only after receiving Direct Post API approval from TikTok.</p>
    </div>

    <div class="scheduling-note">
      <p><strong>Scheduling functionality:</strong> Available only after TikTok Direct Post API approval</p>
      <!-- UPPDATERAD: √Ñndrat fr√•n "future capabilities" -->
      <p style="margin-top: 8px; font-size: 13px;">This demonstrates the user interaction flow for scheduled posts.</p>
    </div>

    <div class="note-box">
      <p><strong>Action Required:</strong> All functions require user clicks. Nothing happens automatically.</p>
      <p><strong>Queue for API approval:</strong> Places the video in a review queue while awaiting TikTok's Direct Post API access.</p>
      <p><strong>Publish:</strong> For immediate publishing once Direct Post API access is granted.</p>
      <p style="margin-top: 10px; color: #E8B65C;"><strong>Unified Terminology:</strong> Always using "Queue for API approval" and "Queued for API approval" for consistency.</p>
    </div>
  </div>

  <div class="back-link">
    <a href="https://caspergrenander.github.io/historienbakomusiken/projekt-info/">‚Üê Back to Main Page</a>
  </div>
</div>

<footer>
  <div class="footer-content">
    <p style="color: #F5E5C8; margin-bottom: 10px;">
      <strong>Historien Bakom Musiken ‚Äì AutoPublisher</strong>
    </p>
    <p style="color: #2A4A4A; margin-bottom: 20px;">
      ¬© 2026 Casper Grenander. All rights reserved.
    </p>
    <div class="footer-links">
      <a href="https://caspergrenander.github.io/historienbakomusiken/projekt-info/">Main Page</a>
      <a href="/historienbakomusiken/integritetspolicy">Privacy Policy</a>
      <a href="/historienbakomusiken/anvandarvillkor">Terms of Use</a>
      <a href="/historienbakomusiken/data-radering">Data Deletion</a>
      <a href="mailto:kontakt.historienbakomusiken@gmail.com">Contact</a>
    </div>
  </div>
</footer>

<script>
let selectedFile = null;
let isCommercial = false;

// DOM Elements
const uploadArea = document.getElementById("uploadArea");
const videoFileInput = document.getElementById("videoFile");
const fileInfo = document.getElementById("fileInfo");
const fileName = document.getElementById("fileName");
const fileSize = document.getElementById("fileSize");
const publishBtn = document.getElementById("publishBtn");
const queueBtn = document.getElementById("queueBtn");
const generateBtn = document.getElementById("generateBtn");
const statusMessage = document.getElementById("statusMessage");
const videoPreview = document.getElementById("videoPreview");
const videoPreviewContainer = document.getElementById("videoPreviewContainer");
const creatorUsername = document.getElementById("creatorUsername");

// TikTok Audit Elements
const privacyDropdown = document.getElementById("privacy");
const commercialToggle = document.getElementById("commercialToggle");
const commercialOptions = document.getElementById("commercialOptions");
const commercialYourBrand = document.getElementById("commercialYourBrand");
const commercialBrandedContent = document.getElementById("commercialBrandedContent");
const consentCheckbox = document.getElementById("consentCheckbox");
const allowComment = document.getElementById("allowComment");
const allowDuet = document.getElementById("allowDuet");
const allowStitch = document.getElementById("allowStitch");

// Validation Elements
const privacyError = document.getElementById("privacyError");
const commercialError = document.getElementById("commercialError");
const consentError = document.getElementById("consentError");

// Initialize with demo username (in production this would come from TikTok OAuth)
function setCreatorUsername(username) {
  creatorUsername.textContent = username || "@demo_user_123";
}

// Upload Area Click Handler
uploadArea.addEventListener('click', () => {
  videoFileInput.click();
});

// Drag and Drop Functionality
uploadArea.addEventListener('dragover', (e) => {
  e.preventDefault();
  uploadArea.classList.add('active');
});

uploadArea.addEventListener('dragleave', () => {
  uploadArea.classList.remove('active');
});

uploadArea.addEventListener('drop', (e) => {
  e.preventDefault();
  uploadArea.classList.remove('active');

  if (e.dataTransfer.files.length) {
    videoFileInput.files = e.dataTransfer.files;
    handleFileSelect();
  }
});

// File Input Change Handler
videoFileInput.addEventListener('change', handleFileSelect);

function handleFileSelect() {
  if (videoFileInput.files.length > 0) {
    selectedFile = videoFileInput.files[0];

    // Update file info display
    fileName.textContent = selectedFile.name;
    fileSize.textContent = formatFileSize(selectedFile.size);
    fileInfo.style.display = 'block';

    // Show video preview
    const videoURL = URL.createObjectURL(selectedFile);
    videoPreview.src = videoURL;
    videoPreviewContainer.classList.add('show');

    // Validate form
    validateForm();
  }
}

function formatFileSize(bytes) {
  if (bytes === 0) return '0 Bytes';
  const k = 1024;
  const sizes = ['Bytes', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

// Status Message Function
function showStatus(message, type = 'processing', subtext = '') {
  statusMessage.innerHTML = message;
  if (subtext) {
    statusMessage.innerHTML += `<div class="status-subtext">${subtext}</div>`;
  }
  statusMessage.className = `status-message status-${type} show`;

  // Auto-hide success messages after 5 seconds
  if (type === 'success' || type === 'queued') {
    setTimeout(() => {
      statusMessage.classList.remove('show');
    }, 5000);
  }
}

// Generate Suggestions Button
generateBtn.addEventListener('click', () => {
  showStatus('Generating caption & hashtags suggestions...', 'processing', 'Connecting to backend AI service');

  // Simulate API call (this is a mock/demo)
  setTimeout(() => {
    document.getElementById("caption").value = "üéµ Behind the scenes of my latest track! See the creative process from start to finish. #MusicProduction";
    document.getElementById("hashtags").value = "#musicproduction #behindthescenes #creativity #musicmaker #studio";
    showStatus('Suggestions generated successfully!', 'success', 'AI-powered suggestions added to fields');
  }, 1500);
});

// Commercial Toggle Handler
commercialToggle.addEventListener('change', function() {
  isCommercial = this.checked;
  if (isCommercial) {
    commercialOptions.classList.add('show');
  } else {
    commercialOptions.classList.remove('show');
    commercialYourBrand.checked = false;
    commercialBrandedContent.checked = false;
  }
  validateForm();
});

// Form Validation Function
function validateForm() {
  let isValid = true;
  
  // Reset errors
  privacyError.classList.remove('show');
  commercialError.classList.remove('show');
  consentError.classList.remove('show');

  // Check privacy selection
  if (!privacyDropdown.value) {
    privacyError.classList.add('show');
    isValid = false;
  }

  // Check commercial content if toggled
  if (isCommercial) {
    if (!commercialYourBrand.checked && !commercialBrandedContent.checked) {
      commercialError.classList.add('show');
      isValid = false;
    }
  }

  // Check consent
  if (!consentCheckbox.checked) {
    consentError.classList.add('show');
    isValid = false;
  }

  // Check file selection
  if (!selectedFile) {
    isValid = false;
  }

  // Enable/disable buttons based on validation
  publishBtn.disabled = !isValid;
  queueBtn.disabled = !isValid;

  return isValid;
}

// Add event listeners for validation
privacyDropdown.addEventListener('change', validateForm);
commercialYourBrand.addEventListener('change', validateForm);
commercialBrandedContent.addEventListener('change', validateForm);
consentCheckbox.addEventListener('change', validateForm);

// Publish Button (for when API is approved)
publishBtn.addEventListener('click', () => {
  if (!validateForm()) return;

  showStatus('Publishing to TikTok via Direct Post API...', 'processing', 'User-initiated action in progress (Demo mode)');

  // Simulate publishing process
  setTimeout(() => {
    showStatus('‚úÖ Video published successfully to TikTok!', 'success', 'User action completed successfully (Demo mode)');

    // Reset form
    resetForm();
  }, 3000);
});

// Queue for API Approval Button
queueBtn.addEventListener('click', () => {
  if (!validateForm()) return;

  showStatus('Queued for API approval', 'queued', 'Video added to review queue for TikTok Direct Post API approval');

  // Simulate queuing process
  setTimeout(() => {
    showStatus('‚úÖ Video queued for API approval!', 'success', 'Awaiting TikTok Direct Post API approval - User action completed');

    // Reset form
    resetForm();
  }, 2000);
});

// Reset form function
function resetForm() {
  publishBtn.disabled = true;
  queueBtn.disabled = true;
  fileInfo.style.display = 'none';
  videoPreviewContainer.classList.remove('show');
  videoPreview.src = '';
  videoFileInput.value = '';
  selectedFile = null;
  
  // Reset form fields
  document.getElementById("caption").value = '';
  document.getElementById("hashtags").value = '';
  privacyDropdown.selectedIndex = 0;
  commercialToggle.checked = false;
  commercialOptions.classList.remove('show');
  commercialYourBrand.checked = false;
  commercialBrandedContent.checked = false;
  consentCheckbox.checked = false;
  allowComment.checked = false;
  allowDuet.checked = false;
  allowStitch.checked = false;
  
  // Clear errors
  privacyError.classList.remove('show');
  commercialError.classList.remove('show');
  consentError.classList.remove('show');
}

// Initialize
setCreatorUsername();
statusMessage.classList.remove('show');

// Auto-validate when page loads
setTimeout(validateForm, 100);
</script>

</body>
</html>